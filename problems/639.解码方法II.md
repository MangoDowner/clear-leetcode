# 639. 解码方法 II
一条包含字母A-Z 的消息通过以下的方式进行了编码：
```
'A' -> 1
'B' -> 2
...
'Z' -> 26
```
除了上述的条件以外，现在加密字符串可以包含字符 '*'了，字符'*'可以被当做1到9当中的任意一个数字。

给定一条包含数字和字符'*'的加密信息，请确定解码方法的总数。

同时，由于结果值可能会相当的大，所以你应当对109+ 7取模。（翻译者标注：此处取模主要是为了防止溢出）

示例 1 :
```
输入: "*"
输出: 9
解释: 加密的信息可以被解密为: "A", "B", "C", "D", "E", "F", "G", "H", "I".
```
示例 2 :
```



输出: 9 + 9 = 18（翻译者标注：这里1*可以分解为1,* 或者当做1*来处理，所以结果是9+9=18）
```
说明 :
```
输入的字符串长度范围是 [1, 105]。
输入的字符串只会包含字符 '*' 和 数字'0' - '9'。
```

## 动态规划
### 解题思路
见代码

### 代码

```csharp
public class Solution {
    public int NumDecodings(string s)
    {
        const int M = 1000000007;

        var dp = new long[s.Length + 1];
        // 空字符串只有一种
        dp[0] = 1; 
        // 单字符串，*有9中，0没有，其他都是1种
        dp[1] = s[0] == '*' ? 9 : s[0] == '0' ? 0 : 1; 
        for (var i = 1; i < s.Length; i++)
        {
            if (s[i] == '*') 
            {
                // *不和前面的进行组合，就有这9 * dp[i]种
                dp[i + 1] = 9 * dp[i]; 
                if (s[i - 1] == '1') // 和前面的1组合,即当做1*来处理，可以是11-19，再增加 9 * dp[i - 1]种
                    dp[i + 1] = (dp[i + 1] + 9 * dp[i - 1]) % M;
                else if (s[i - 1] == '2') // 和前面的2组合,即当做2*来处理，可以是21-26，再增加 6 * dp[i - 1]种
                    dp[i + 1] = (dp[i + 1] + 6 * dp[i - 1]) % M;
                else if (s[i - 1] == '*') // 和前面的1或者2组合，即上面两种相加
                    dp[i + 1] = (dp[i + 1] + 15 * dp[i - 1]) % M;
            }
            else
            {
                // 如果是0，不可以单独组合，只能和前一个字母组合
                dp[i + 1] = s[i] != '0' ? dp[i] : 0;
                if (s[i - 1] == '1') // 和前面的1组合，s[i]是任意数字都行，增加dp[i-1]种
                    dp[i + 1] = (dp[i + 1] + dp[i - 1]) % M; 
                else if (s[i - 1] == '2' && s[i] <= '6') // 和前面的2组合，只可以是21-26,也就是s[i]<=6
                    dp[i + 1] = (dp[i + 1] + dp[i - 1]) % M;
                else if (s[i - 1] == '*') // 只有s[i-1]是1和2时候，才有意义，也就是上面两者相加
                    dp[i + 1] = (dp[i + 1] + (s[i] <= '6' ? 2 : 1) * dp[i - 1]) % M;
            }

            dp[i + 1] %= M;
        }

        return (int)dp[s.Length];
    }
}
```
